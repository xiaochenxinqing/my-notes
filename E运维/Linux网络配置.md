# **ä¸€ã€é…ç½®IP**





**ä¸€ã€é€šè¿‡å‘½ä»¤è¡Œé…ç½®(é‡å¯ç³»ç»Ÿæˆ–ç½‘å¡ä¼šå¤±æ•ˆ)**

â€‹    **#è®¾ç½®ens3ç½‘å¡çš„é™æ€ipå’Œå­ç½‘æ©ç ****

**ip addr add 192.188.1.220/24 dev ens33**

**ifconfig ens33 192.188.1.220 netmask 255.255.255.0**    



 #   äºŒã€é…ç½®è·¯ç”± #  

**ip route add default via 192.188.1.1    **

**route add default gw 192.188.1.1**#  è®¾ç½®ç³»ç»Ÿé»˜è®¤è·¯ç”±



ip route add 192.168.2.0/24 via 192.168.1.1 è®¾ç½®192.168.2.0ç½‘æ®µçš„ç½‘å…³ä¸º192.168.1.1

ip route add 192.168.4.0/24 via 192.168.0.254 dev eth0 è®¾ç½®192.168.4.0ç½‘æ®µçš„ç½‘å…³ä¸º192.168.0.254,æ•°æ®èµ°eth0æ¥å£

ip route add default via 192.168.0.254 dev eth0 è®¾ç½®é»˜è®¤ç½‘å…³ä¸º192.168.0.254

ip route add default via 192.168.1.1 table 1 åœ¨ä¸€å·è¡¨ä¸­æ·»åŠ é»˜è®¤è·¯ç”±ä¸º192.168.1.1

ip route add 192.168.0.0/24 via 192.168.1.2 table 1 åœ¨ä¸€å·è¡¨ä¸­æ·»åŠ ä¸€æ¡åˆ°192.168.0.0ç½‘æ®µçš„è·¯ç”±ä¸º192.168.1.2

ip route add prohibit 209.10.26.51 è®¾ç½®è¯·æ±‚çš„ç›®çš„åœ°ä¸å¯è¾¾çš„è·¯ç”±

ip route add prohibit 209.10.26.51 from 192.168.99.35 å‡è®¾æ‚¨ä¸æƒ³é˜»æ­¢æ‰€æœ‰ç”¨æˆ·è®¿é—®æ­¤ç‰¹å®šä¸»æœºï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¯¥fromé€‰é¡¹ï¼Œé˜»æ­¢äº†æºIP 192.168.99.35åˆ°è¾¾209.10.26.51

ip route change default via 192.168.99.113 dev eth0 æ›´æ”¹é»˜è®¤è·¯ç”±ã€‚æ­¤æ“ä½œç­‰åŒäºå…ˆåˆ é™¤ï¼Œåæ–°å¢





## ä¸‰ã€åˆ é™¤è·¯ç”±çš„è¯­æ³•

#### âœ… 1. ä½¿ç”¨ `ip route` åˆ é™¤è·¯ç”±

åŸºæœ¬è¯­æ³•ï¼š

```
ip route del <ç›®æ ‡ç½‘ç»œ> [via <ç½‘å…³>] [dev <æ¥å£>]
```

**ç¤ºä¾‹ 1ï¼šåˆ é™¤ç›´è¿è·¯ç”±**

```
ip route del 192.168.10.0/24 dev eth0
```

**ç¤ºä¾‹ 2ï¼šåˆ é™¤æŒ‡å®šç½‘å…³çš„è·¯ç”±**

```
ip route del 10.0.0.0/8 via 192.168.1.1
```

**ç¤ºä¾‹ 3ï¼šåˆ é™¤é»˜è®¤è·¯ç”±**

```
ip route del default via 192.168.1.1
```

> ğŸ’¡ å¯ä»¥å…ˆç”¨ `ip route show` æŸ¥çœ‹å½“å‰æ‰€æœ‰è·¯ç”±ï¼Œç„¶åå¤åˆ¶éœ€è¦åˆ é™¤çš„é‚£è¡Œï¼Œæ”¹æˆ `ip route del` å³å¯ã€‚

------

#### âœ… 2. ä½¿ç”¨ `route` å‘½ä»¤åˆ é™¤è·¯ç”±

åŸºæœ¬è¯­æ³•ï¼š

```
route del -net <ç›®æ ‡ç½‘ç»œ> netmask <æ©ç > [gw <ç½‘å…³>] [dev <æ¥å£>]
```

**ç¤ºä¾‹ 1ï¼šåˆ é™¤ç›´è¿è·¯ç”±**

```
route del -net 192.168.10.0 netmask 255.255.255.0 dev eth0
```

**ç¤ºä¾‹ 2ï¼šåˆ é™¤æŒ‡å®šç½‘å…³è·¯ç”±**

```
route del -net 10.0.0.0 netmask 255.0.0.0 gw 192.168.1.1
```

**ç¤ºä¾‹ 3ï¼šåˆ é™¤é»˜è®¤è·¯ç”±**

```
route del default gw 192.168.1.1
```



## ä¸‰ã€é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®IPåœ°å€å’Œç½‘å…³



1ã€ä¿®æ”¹ç½‘å¡é…ç½®æ–‡ä»¶

vim /etc/sysconfig/network-scripts/ifcfg-eth0

æ”¹BOOTPROTO="dhcp" è‡ªåŠ¨è·å–IP

ONBOOT="yes" å¼€æœºè‡ªåŠ¨å¯ç”¨ç½‘å¡

2ã€é™æ€IPåœ°å€ã€‚

vim /etc/sysconfig/network-scripts/ifcfg-eth0  

ifcfg-eth0æ–‡ä»¶ä¸­dhcpæ”¹ä¸ºé™æ€IPï¼Œéœ€è¦æ”¹ BOOTPROTO=static

å¹¶ä¸”æ·»åŠ ä¸‹é¢ä¸‰è¡Œå‚æ•°ï¼ŒIPåœ°å€ã€å­ç½‘æ©ç ã€ç½‘å…³

IPADDR=192.168.2.41

NETMASK=255.255.255.0

GATEWAY=192.168.2.1

 ä¿®æ”¹å®Œåé‡å¯ç½‘å¡

    systemctl restart network

äºŒã€é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®IPåœ°å€å’Œç½‘å…³ï¼ˆubuntu ï¼ˆ18.04ï¼‰netplanï¼‰ï¼š

cd /etc/netplan ä¿®æ”¹ç›¸åº”é…ç½®æ–‡ä»¶



## å››ã€NMCLIæ–¹æ³•é…ç½®

##æ·»åŠ è¿æ¥ ä¼šåœ¨ /etc/sysconfig/network-scriptsä¸­æ·»åŠ æ–‡ä»¶æŒä¹…åŒ–

nmcli con add con-name "æ–°çš„ connection åå­—"  type  ethernet  ifname  "å¯¹åº”device åå­—"  ipv4.address  IPåœ°å€/å­ç½‘æ©ç   ipv4.gateway IPç½‘å…³åœ°å€ ipv4.dns DNSåœ°å€ ipv4.method manual     autoconnect yes  (å°†å¯åŠ¨ç½‘å¡è®¾ç½® ä¸ºå›ºå®šIPåœ°å€)  

   æ³¨æ„: ipv4.method manual    ä¸èƒ½çœç•¥

##æ›´æ–°è¿æ¥

nmcli  con modify  [è¿æ¥åç§°]  ipv4.address 192.188.1.103/24 ipv4.gateway 192.188.1.1 ipv4.method manual     ipv4.dns 8.8.8.8

##é‡è½½

nmcli con reload   è¿™æ—¶å€™ä¸€èˆ¬å°±èƒ½è”äº†

##å¯åŠ¨è¿æ¥

nmcli con up  è¿æ¥å

#å¼€æœºè‡ªåŠ¨è¿æ¥

nmcli connection modify è¿æ¥å connection.autoconnect yes

##å…¶ä»–

nmcli dev con è®¾å¤‡å   

(æ³¨æ„:  nmcli con up å’Œ nmcli dev con éƒ½ä¼šç«‹å³è®©æ–°ç½‘ç»œè®¾ç½®ç”Ÿæ•ˆ,   ä½†  nmcli dev conä¼šå¯¼è‡´è¿™ä¸ªè®¾å¤‡éšæœºè¿æ¥è¯¥è®¾å¤‡ä¸‹çš„æŸä¸ªé“¾æ¥,æ‰€ä»¥æœ€å¥½ç”¨ä¸Šé¢çš„con up)



iptableé˜²ç«å¢™ï¼šï¼š

```SQL
iptables -P INPUT ACCEPT
iptables -F
iptables -vL

sudo tcpdump -i eth0 port 2181 -w /mnt/dbsec/2181.pcap
```

===========

é»˜è®¤è·¯ç”±å¯ä»¥æœ‰å¤šä¸ª ä½†åªæœ‰ä¼˜å…ˆçº§æœ€é«˜çš„é‚£ä¸ªä¼šç”Ÿæ•ˆ

è‹¥æ’äº†ä¸åŒç½‘æ®µçš„ä¸¤æ ¹ç½‘çº¿ï¼Œåˆ™ä¸€èˆ¬çš„åæ’çš„ç½‘çº¿é»˜è®¤è·¯ç”±ä¼˜å…ˆçº§é«˜ï¼ŒåŸæ¥çš„å†…ç½‘ï¼ŒåŒç½‘æ®µè¿˜æ˜¯å¯ä»¥è®¿é—®çš„ï¼Œè‹¥è¦è®¿é—®å…¶ä»–ç½‘æ®µ éœ€è¦æ·»åŠ è·¯ç”±



å¦‚

å†…ç½‘è¿äº†å¤–ç½‘ä»¥åï¼š

route PRINT -4æŸ¥çœ‹ æ–°è¿æ¥å¸¦æ¥çš„é»˜è®¤è·¯ç”±ä¼˜å…ˆçº§æ›´é«˜ï¼Œæ‰€æœ‰å†…ç½‘å°±åªèƒ½è®¿é—®192.168.18.xxxäº†ï¼Œ  192.188.1.xå’Œ192.188.4.x éƒ½æ— æ³•è®¿é—®äº†ï¼Œéœ€è¦æ·»åŠ è·¯ç”±

route add 192.188.1.0 mask 255.255.255.0 192.168.18.1 metric 5 -p

route add 192.188.4.0 mask 255.255.255.0 192.168.18.1 metric 5 -p
